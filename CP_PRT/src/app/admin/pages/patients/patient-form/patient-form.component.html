<div class="page-header">
  <div class="left">
    <button class="back-btn" (click)="router.navigate(['/admin/patients'])">←</button>
    <h2>
      @if (id()) { Edit Patient } @else { Create Patient }
    </h2>
  </div>

  <button class="btn-primary" (click)="save()">Save</button>
</div>

<div class="edit-container">
  <div class="card">
    <form [formGroup]="form">

      <div class="form-grid form-grid-2">

        <!-- Prenume -->
        <div class="form-group">
          <label>Prenume</label>
          <input type="text"
                 formControlName="firstName"
                 [class.invalid]="hasError('firstName','required')">

          @if (hasError('firstName','required')) {
            <div class="error">Prenumele este obligatoriu.</div>
          }
        </div>

        <!-- Nume -->
        <div class="form-group">
          <label>Nume</label>
          <input type="text"
                 formControlName="lastName"
                 [class.invalid]="hasError('lastName','required')">

          @if (hasError('lastName','required')) {
            <div class="error">Numele este obligatoriu.</div>
          }
        </div>

        <!-- Telefon -->
        <div class="form-group">
          <label>Telefon</label>
          <input type="text"
                 formControlName="phone"
                 [class.invalid]="hasError('phone','required')">

          @if (hasError('phone','required')) {
            <div class="error">Telefonul este obligatoriu.</div>
          }
        </div>

        <!-- Email -->
        <div class="form-group">
          <label>Email</label>
          <input type="email"
                 formControlName="email"
                 [class.invalid]="hasError('email','email')">

          @if (hasError('email','email')) {
            <div class="error">Email invalid.</div>
          }
        </div>

        <!-- Data nașterii -->
        <div class="form-group">
          <label>Data nașterii</label>
          <input type="date"
                 formControlName="dateOfBirth"
                 [class.invalid]="hasError('dateOfBirth','required')">

          @if (hasError('dateOfBirth','required')) {
            <div class="error">Data nașterii este obligatorie.</div>
          }
        </div>

        <!-- Cabinet -->
        @if (isSuperAdmin()) {
          <div class="form-group">
            <label>Cabinet</label>
            <select formControlName="cabinetId"
                    [class.invalid]="hasError('cabinetId','required')">

              <option [ngValue]="null"></option>

              @for (cab of cabinets(); track cab.id) {
                <option [ngValue]="cab.id">{{ cab.name }}</option>
              }

            </select>

            @if (hasError('cabinetId','required')) {
              <div class="error">Cabinetul este obligatoriu.</div>
            }
          </div>
        }

        <!-- Notes -->
        <div class="form-group full-width">
          <label>Notițe</label>
          <input type="text" formControlName="notes">
        </div>

      </div>

    </form>
  </div>
</div>
